let e,t,o,n,s,a,l,r,h,c,d,f=100,u=0;class m{constructor(e,t){this.pos=new Vector(e,t),this.vel=new Vector(Math.random()-5.5,Math.random()-5.5),this.acc=new Vector(0,0),this.size=1.5}move(e){e&&this.acc.addTo(e),this.vel.addTo(this.acc),this.pos.addTo(this.vel),this.vel.getLength()>1&&this.vel.setLength(1),this.acc.setLength(0)}draw(){t.fillRect(this.pos.x,this.pos.y,this.size,this.size)}wrap(){this.pos.x>n?this.pos.x=0:this.pos.x<-this.size&&(this.pos.x=n-1),this.pos.y>s?this.pos.y=0:this.pos.y<-this.size&&(this.pos.y=s-1)}}const g=(e,t=1)=>{let o=e.replace("#","");3===o.length&&(o=`${o[0]}${o[0]}${o[1]}${o[1]}${o[2]}${o[2]}`);return t>1&&t<=100&&(t/=100),`rgba(${parseInt(o.substring(0,2),16)},${parseInt(o.substring(2,4),16)},${parseInt(o.substring(4,6),16)},${t})`};let p,M=getComputedStyle(document.documentElement).getPropertyValue("--bg"),w=getComputedStyle(document.documentElement).getPropertyValue("--bg-dark"),v=getComputedStyle(document.documentElement).getPropertyValue("--base-dark"),y=getComputedStyle(document.documentElement).getPropertyValue("--base-bright"),b=M,P=v,x=-1;function T(){P==v?(b=w,P=y):(b=M,P=v),q()}function S(e=30){a=e,h=0,noise.seed(Math.random()),t.strokeStyle=P,t.lineWidth=1,noise.seed(Math.random()),l=Math.floor(n/a)+1,r=Math.floor(s/a)+1,function(){d=[];let e=n*s/1e3;for(let t=0;t<e;t++){let e=new m(Math.random()*n,Math.random()*s);d.push(e)}}(),function(){o=new Array(l);for(let e=0;e<l;e++){o[e]=new Array(l);for(let t=0;t<r;t++)o[e][t]=[0,0]}}()}e=document.querySelector("#canvas"),t=e.getContext("2d",{alpha:!1}),window.addEventListener("resize",C),a=30,C(),("dark"===localStorage.theme||(!("theme"in localStorage)&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)")).matches)&&T(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",(function(e){T()})),document.addEventListener("color_change",T,!1);var k=0,$=0;function R(e,t,o){let i=(1-o)*Math.cos(e)+o*Math.cos(t),n=(1-o)*Math.sin(e)+o*Math.sin(t);return Math.atan2(n,i)}function E(e,t){var o=k-e,i=$-t;return Math.sqrt(o*o+i*i)}function I(){t.fillRect(0,0,n,s)}function C(){e.style.width="100%",e.style.height="100%",n=e.width=e.offsetWidth,s=e.height=e.offsetHeight,function(e,t,o,i){if("undefined"==typeof window)return null;var n=window.devicePixelRatio||1;1!==devicePixelRatio&&(n/=2,e.width=o*n,e.height=i*n,console.log("Rescaled Canvas for DPR"),t.scale(n,n))}(e,t,n,s),c=Math.floor(s/2),q()}function L(){requestAnimationFrame(z),function(){for(let n=0;n<l;n++)for(let s=0;s<r;s++){var t=k-e.width/l*n,i=$-e.height/r*s;let a=noise.simplex3(n/50,s/50,h)*Math.PI*2,c=Math.atan2(10*i,10*t)-1.57,d=noise.simplex3(n/50+4e4,s/50+4e4,h),f=R(c,a,Math.sqrt(t*t+i*i)/500);o[n][s][0]=f,o[n][s][1]=.5*d+.5}}(),h+=.003,I(),function(){if(window.chrome)for(let e=0;e<l;e++)for(let i=0;i<r;i++){let n=o[e][i][0],s=o[e][i][1];t.save(),t.translate(e*a,i*a),t.rotate(n),t.beginPath(),t.moveTo(0,0),t.lineTo(0,a*s+10),t.stroke(),t.beginPath(),t.moveTo(0,a*s+10),t.lineTo(-9,a*s+10-9),t.stroke(),t.beginPath(),t.moveTo(0,a*s+10),t.lineTo(9,a*s+10-9),t.stroke(),t.restore()}else for(let e=0;e<l;e++)for(let i=0;i<r;i++){let n=o[e][i][0],s=o[e][i][1];t.save(),t.translate(e*a,i*a),t.rotate(n),t.beginPath(),t.moveTo(0,0),t.lineTo(0,a*s+10),t.lineTo(-9,a*s+10-9),t.moveTo(0,a*s+10),t.lineTo(9,a*s+10-9),t.stroke(),t.restore()}}()}function V(){requestAnimationFrame(z),I(),h+=.002,function(o,i){let n=t.fillStyle;t.fillStyle=P;let s=.66*Math.max(e.width,e.height);const a=170;for(let i=0;i<a;i++){let n=s/a*(a-i),l=a+7-i;for(let s=0;s<=l;s++){let a=Math.cos(s/l*Math.PI*2)*n+e.width/2,r=(E(a,Math.sin(s/l*Math.PI*2)*n+e.height/2)/1e3)**2,h=s+(noise.simplex3(10*a,1.5*o,0)/2+.5)*r,c=Math.cos(h/l*Math.PI*2),d=Math.sin(h/l*Math.PI*2);const f=r*noise.simplex3(c,d+.03*i,o)*(n/5);c*=n+f,d*=n+f,c+=e.width/2,d+=e.height/2,t.fillRect(c,d,3,3)}}t.fillStyle=n}(h)}function q(){0==x&&(S(40),A(),t.fillStyle=g(b,.25)),1==x&&(S(13),A()),2==x&&(A(),t.fillStyle=g(b,.5),t.strokeStyle=P,t.lineWidth=1,t.lineJoin="round")}function z(){switch(p||(p=Date.now()),(Date.now()-p>4500||-1==x)&&(p=null,x=(x+1)%3,q()),x){case 0:L();break;case 1:V();break;case 2:!function(){requestAnimationFrame(z),I(),h+=.002;for(let e=-8;e<8;e++)D(h,e)}()}}function A(){t.fillStyle=b,t.fillRect(0,0,n,s)}function D(e,o){var s=e,a=Math.sin(s);for(t.moveTo(c,f*a+u),t.beginPath(),i=u-1;i<=n;i+=2){s=e+(-u+i)/f,a=Math.sin(s+10*noise.simplex3(0,o/30,h))+o/1.6;var l=Math.abs(k-f*s)/15,r=Math.abs($-f*a-c)/15;t.lineTo(i,f*a+c+(l+r)*noise.simplex3(i,0,h)*noise.simplex3(s/3,10,h))}t.stroke()}document.addEventListener("mousemove",(t=>{var o=e.getBoundingClientRect();k=.9*k+.1*(t.clientX-o.left),$=.9*$+.1*(t.clientY-o.top)})),A(),z();